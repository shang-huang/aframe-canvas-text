!function(){"use strict";function e(e,t){return String.fromCodePoint(parseInt(e.substring(0,t),16))}function t(e){return document.createElement(e)}AFRAME.registerComponent("canvas-text",{schema:{value:{type:"string"},size:{type:"int",default:50},color:{type:"color",default:"black"},side:{type:"string",default:"front",oneOf:["front","back","double"]},align:{type:"string",default:"left",oneOf:["left","center","right"]}},init(){this.canvas=t("canvas")},update(i){i!=this.data&&function(i,n,l){const a=window.devicePixelRatio,r=window.getComputedStyle(document.body,null).getPropertyValue("font-family"),s=`${n.size*a}px ${r}`;let o=function(t){let i="",n=t.split("\\u");return n.forEach((t,l)=>{if(0===l)i+=t;else{let a=e(t,5);if(/[\u{10000}-\u{2ffff}]/u.test(a))i+=a+t.substring(5,n[l].length);else{let a=e(t,4);/[\u{0000}-\u{ffff}]/u.test(a)?i+=a+t.substring(4,n[l].length):i+=t}}}),i}(n.value).replace(/\\n/g,"\n").split("\n"),c=t("div");c.style.display="inline-block",i.appendChild(c);let f=[];o.forEach(e=>{let i=t("span");i.style.font=s,i.innerText=e,c.appendChild(i),f.push(i.offsetHeight);let n=t("br");n.style.lineHeight=0,c.appendChild(n)});let d=c.offsetWidth,u=c.offsetHeight;(function(e,t,i,n,l,a,r,s){let o=e.getContext("2d");e.width=t,e.height=i,o.clearRect(0,0,t,i),o.font=n,o.textBaseline="middle",o.fillStyle=l;let c=0;r.forEach((e,i)=>{let n=s[i]/2+c;switch(a){case"left":o.textAlign="left",o.fillText(e,0,n);break;case"center":o.textAlign="center",o.fillText(e,t/2,n);break;case"right":o.textAlign="right",o.fillText(e,t,n)}c+=s[i]})})(l,d,u,s,n.color,n.align,o,f),function(e,t,i,n,l,a){const r=.0075/l;e.object3D.children.forEach(t=>e.object3D.remove(t));let s=new THREE.CanvasTexture(t);s.wrapS=THREE.ClampToEdgeWrapping,s.wrapT=THREE.ClampToEdgeWrapping,s.magFilter=THREE.LinearFilter,s.minFilter=THREE.LinearFilter;let o=new THREE.MeshBasicMaterial({map:s});switch(o.precision="lowp",o.flatShading=!0,o.transparent=!0,a){case"front":o.side=THREE.FrontSide;break;case"back":o.side=THREE.BackSide;break;case"double":o.side=THREE.DoubleSide}let c=new THREE.PlaneGeometry(i*r,n*r,1,1),f=new THREE.Mesh(c,o);e.object3D.add(f)}(i,l,d,u,a,n.side),i.removeChild(c)}(this.el,this.data,this.canvas)}})}();
