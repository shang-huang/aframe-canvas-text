!function(){"use strict";function e(e,t){return String.fromCodePoint(parseInt(e.substring(0,t),16))}function t(e){return document.createElement(e)}AFRAME.registerComponent("canvas-text",{schema:{value:{type:"string"},size:{type:"int",default:50},color:{type:"color",default:"black"},align:{type:"string",default:"left",oneOf:["left","center","right"]}},init(){this.canvas=t("canvas")},update(n){n!=this.data&&function(n,i,l){const a=window.devicePixelRatio,r=window.getComputedStyle(document.body,null).getPropertyValue("font-family"),s=`${i.size*a}px ${r}`;let o=function(t){let n="",i=t.split("\\u");return i.forEach((t,l)=>{if(0===l)n+=t;else{let a=e(t,5);if(/[\u{10000}-\u{2ffff}]/u.test(a))n+=a+t.substring(5,i[l].length);else{let a=e(t,4);/[\u{0000}-\u{ffff}]/u.test(a)?n+=a+t.substring(4,i[l].length):n+=t}}}),n}(i.value).replace(/\\n/g,"\n").split("\n"),f=t("div");f.style.display="inline-block",n.appendChild(f);let c=[];o.forEach(e=>{let n=t("span");n.style.font=s,n.innerText=e,f.appendChild(n),c.push(n.offsetHeight);let i=t("br");i.style.lineHeight=0,f.appendChild(i)});let d=f.offsetWidth,u=f.offsetHeight;(function(e,t,n,i,l,a,r,s){let o=e.getContext("2d");e.width=t,e.height=n,o.clearRect(0,0,t,n),o.font=i,o.textBaseline="middle",o.fillStyle=l;let f=0;r.forEach((e,n)=>{let i=s[n]/2+f;switch(a){case"left":o.textAlign="left",o.fillText(e,0,i);break;case"center":o.textAlign="center",o.fillText(e,t/2,i);break;case"right":o.textAlign="right",o.fillText(e,t,i)}f+=s[n]})})(l,d,u,s,i.color,i.align,o,c),function(e,t,n,i,l){const a=.0075/l;e.object3D.children.forEach(t=>e.object3D.remove(t));let r=new THREE.CanvasTexture(t);r.wrapS=THREE.ClampToEdgeWrapping,r.wrapT=THREE.ClampToEdgeWrapping,r.magFilter=THREE.LinearFilter,r.minFilter=THREE.LinearFilter;let s=new THREE.MeshBasicMaterial({map:r});s.precision="lowp",s.flatShading=!0,s.transparent=!0,s.side=THREE.DoubleSide;let o=new THREE.PlaneGeometry(n*a,i*a,1,1),f=new THREE.Mesh(o,s);e.object3D.add(f)}(n,l,d,u,a),n.removeChild(f)}(this.el,this.data,this.canvas)}})}();
